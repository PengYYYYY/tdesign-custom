import{V as B,k as O,l as b,N as w,i as d,aa as I,aJ as j,j as T,g as $,E as F,f as H}from"./index.7bc89517.js";import{T as L,h as C}from"./dep-63c1cdf0.b07068b1.js";import{w as A}from"./withInstall.366c09a7.js";import{r as h,m as M,a as W,c as z,b as K}from"./render-tnode.dfc92ed6.js";import{T as U}from"./loading.87460b61.js";import{e as c}from"./event.5d1b95d9.js";import{a as P,r as X,g as Y}from"./dom.0201a9cf.js";/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */var p=A(L);/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */function x(n){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(!(!n||!n.$children||t>=6))for(var e=n.$children,o=0,i=e.length;o<i;o++){var s,a,r=e[o],u=r==null||(s=r.$options)===null||s===void 0?void 0:s.name;if(u&&/(TTable|TBaseTable|TPrimaryTable|TEnhancedTable)/i.test(u)&&r.refreshTable){r.refreshTable();return}r!=null&&(a=r.$children)!==null&&a!==void 0&&a.length&&x(r,t+1)}}function G(n){x(n)}/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */function k(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,o)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?k(Object(e),!0).forEach(function(o){d(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):k(Object(e)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}var V=B.extend({methods:{getConfirmBtn:function(t){var e=this.$createElement,o=t.confirmBtn,i=t.className;if(o===null)return null;o&&this.$scopedSlots.confirmBtn&&console.warn("Both $props.confirmBtn and $scopedSlots.confirmBtn exist, $props.confirmBtn is preferred.");var s=this.getDefaultConfirmBtnProps(t);return!o&&!this.$scopedSlots.confirmBtn?e(p,C([{class:i},{props:l({},s)}])):o&&["string","object"].includes(O(o))?this.getButtonByProps(o,s,i):h(this,"confirmBtn")},getCancelBtn:function(t){var e=this.$createElement,o=t.cancelBtn,i=t.className;if(o===null)return null;o&&this.$scopedSlots.cancelBtn&&console.warn("Both $props.cancelBtn and $scopedSlots.cancelBtn exist, $props.cancelBtn is preferred.");var s=this.getDefaultCancelBtnProps(t);return!o&&!this.$scopedSlots.cancelBtn?e(p,C([{class:i},{props:l({},s)}])):o&&["string","object"].includes(O(o))?this.getButtonByProps(o,s):h(this,"cancelBtn")},getButtonByProps:function(t,e,o){var i=this.$createElement,s=e;return b(t)?s.content=t:w(t)&&(s=l(l({},s),t)),i(p,C([{class:o},{props:s}]))},confirmBtnAction:function(t){},cancelBtnAction:function(t){},getDefaultConfirmBtnProps:function(t){var e=this,o=t.globalConfirm,i=t.theme,s=t.globalConfirmBtnTheme,a=(s==null?void 0:s[i])||"primary",r={theme:a,content:"\u786E\u5B9A",size:t.size,onClick:function(D){e.confirmBtnAction(D)}};return b(o)?r.content=o:w(o)&&(r=l(l({},r),o)),r},getDefaultCancelBtnProps:function(t){var e=this,o=t.globalCancel,i={theme:"default",content:"\u53D6\u6D88",size:t.size,onClick:function(a){e.cancelBtnAction(a)}};return b(o)?i.content=o:w(o)&&(i=l(l({},i),o)),i}}});/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */var q={attach:{type:[String,Function],default:""},body:{type:[String,Function],default:""},cancelBtn:{type:[String,Object,Function],default:""},closeBtn:{type:[String,Boolean,Function],default:!0},closeOnEscKeydown:{type:Boolean,default:void 0},closeOnOverlayClick:{type:Boolean,default:void 0},confirmBtn:{type:[String,Object,Function],default:""},confirmOnEnter:Boolean,default:{type:[String,Function]},destroyOnClose:Boolean,draggable:Boolean,footer:{type:[Boolean,Function],default:!0},header:{type:[String,Boolean,Function],default:!0},mode:{type:String,default:"modal",validator:function(t){return t?["modal","modeless","normal"].includes(t):!0}},placement:{type:String,default:"top",validator:function(t){return t?["top","center"].includes(t):!0}},preventScrollThrough:{type:Boolean,default:!0},showInAttachedElement:Boolean,showOverlay:{type:Boolean,default:!0},theme:{type:String,default:"default",validator:function(t){return t?["default","info","warning","danger","success"].includes(t):!0}},top:{type:[String,Number]},visible:Boolean,width:{type:[String,Number]},zIndex:{type:Number},onCancel:Function,onClose:Function,onCloseBtnClick:Function,onClosed:Function,onConfirm:Function,onEscKeydown:Function,onOpened:Function,onOverlayClick:Function};/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */var g=[],J=function(t){g.push(t)},Q=function(){g.pop()},m={push:J,pop:Q,get top(){return g[g.length-1]}};/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */function S(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,o)}return e}function Z(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?S(Object(e),!0).forEach(function(o){d(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):S(Object(e)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}function R(n){return isNaN(Number(n))?n:"".concat(Number(n),"px")}var f,tt=function(t){f={x:t.clientX,y:t.clientY},setTimeout(function(){f=null},100)};typeof window<"u"&&window.document&&window.document.documentElement&&document.documentElement.addEventListener("click",tt,!0);var et=M(V,z("dialog"),W()).extend({name:"TDialog",components:{TButton:p},data:function(){return{uid:0,scrollWidth:0,disX:0,disY:0,windowInnerWidth:0,windowInnerHeight:0,dialogW:0,dialogH:0,dLeft:0,dTop:0}},props:Z({},q),computed:{isModal:function(){return this.mode==="modal"},isModeLess:function(){return this.mode==="modeless"},isNormal:function(){return this.mode==="normal"},maskClass:function(){return["".concat(this.componentName,"__mask"),!this.showOverlay&&"".concat(this.classPrefix,"-is-hidden")]},dialogClass:function(){var t=["".concat(this.componentName),"".concat(this.componentName,"--default"),"".concat(this.componentName,"__modal-").concat(this.theme),this.isModeLess&&this.draggable&&"".concat(this.componentName,"--draggable")];return t},positionClass:function(){if(this.isNormal)return[];var t=["".concat(this.componentName,"__position"),!!this.top&&"".concat(this.componentName,"--top"),"".concat(this.placement&&!this.top?"".concat(this.componentName,"--").concat(this.placement):"")];return t},wrapClass:function(){return[!this.isNormal&&"".concat(this.componentName,"__wrap")]},bodyClass:function(){return["".concat(this.componentName,"__body"),d({},"".concat(this.componentName,"__body--icon"),this.theme!=="default")]},ctxClass:function(){var t;return["".concat(this.componentName,"__ctx"),(t={},d(t,"".concat(this.classPrefix,"-dialog__ctx--fixed"),this.mode==="modal"),d(t,"".concat(this.classPrefix,"-dialog__ctx--absolute"),this.isModal&&this.showInAttachedElement),d(t,"".concat(this.componentName,"__ctx--modeless"),this.isModeLess),t)]},positionStyle:function(){var t={};return this.top!==void 0&&(I(this.top)&&this.top<0?t.paddingTop="".concat(this.top,"px"):t.paddingTop=this.top),t},dialogStyle:function(){return{width:R(this.width)}}},watch:{visible:function(t){var e=this;if(t){var o=this.scrollWidth;if(this.isModal&&!this.showInAttachedElement){if(o>0&&this.preventScrollThrough){var i="position: relative;width: calc(100% - ".concat(o,"px);");document.body.style.cssText=i}this.preventScrollThrough&&P(document.body,"".concat(this.componentName,"--lock")),this.$nextTick(function(){var s=e.$refs.dialog;f&&s&&(s.style.transformOrigin="".concat(f.x-s.offsetLeft,"px ").concat(f.y-s.offsetTop,"px"))})}document.activeElement.blur()}else document.body.style.cssText="",X(document.body,"".concat(this.componentName,"--lock"));this.storeUid(t),this.addKeyboardEvent(t),this.isModeLess&&this.draggable&&this.initDragEvent(t),t&&!this.destroyOnClose&&requestAnimationFrame&&requestAnimationFrame(function(){G(e)})}},mounted:function(){this.scrollWidth=window.innerWidth-document.body.offsetWidth,this.draggable&&window.addEventListener("resize",j(this.resizeAdjustPosition,1e3)),this.visible&&this.isModal&&this.preventScrollThrough&&P(document.body,"".concat(this.componentName,"--lock")),this.uid=this._uid},beforeDestroy:function(){this.addKeyboardEvent(!1)},directives:{TransferDom:U},methods:{storeUid:function(t){t?m.push(this.uid):m.pop()},addKeyboardEvent:function(t){t?(document.addEventListener("keydown",this.keyboardEvent),this.confirmOnEnter&&document.addEventListener("keydown",this.keyboardEnterEvent)):(document.removeEventListener("keydown",this.keyboardEvent),this.confirmOnEnter&&document.removeEventListener("keydown",this.keyboardEnterEvent))},keyboardEvent:function(t){if(t.code==="Escape"&&m.top===this.uid){var e;c(this,"esc-keydown",{e:t}),((e=this.closeOnEscKeydown)!==null&&e!==void 0?e:this.global.closeOnEscKeydown)&&this.emitCloseEvent({e:t,trigger:"esc"})}},keyboardEnterEvent:function(t){var e=t.code;(e==="Enter"||e==="NumpadEnter")&&m.top===this.uid&&c(this,"confirm",{e:t})},overlayAction:function(t){var e;this.showOverlay&&((e=this.closeOnOverlayClick)!==null&&e!==void 0?e:this.global.closeOnOverlayClick)&&t.target===this.$refs.dialogPosition&&(c(this,"overlay-click",{e:t}),this.emitCloseEvent({e:t,trigger:"overlay"}))},closeBtnAction:function(t){c(this,"close-btn-click",{e:t}),this.emitCloseEvent({trigger:"close-btn",e:t})},cancelBtnAction:function(t){c(this,"cancel",{e:t}),this.emitCloseEvent({trigger:"cancel",e:t})},confirmBtnAction:function(t){c(this,"confirm",{e:t})},afterEnter:function(){c(this,"opened")},afterLeave:function(){if(this.isModeLess&&this.draggable){var t=this.$refs.dialog;t.style.position="relative",t.style.left="unset",t.style.top="unset"}c(this,"closed")},emitCloseEvent:function(t){c(this,"close",t),this.$emit("update:visible",!1)},hasEventOn:function(t){var e,o=(e=this._events)===null||e===void 0?void 0:e[t];return!!(o!=null&&o.length)},getIcon:function(){var t=this.$createElement,e=this.useGlobalIcon({InfoCircleFilledIcon:T,CheckCircleFilledIcon:$,ErrorCircleFilledIcon:F}),o=e.InfoCircleFilledIcon,i=e.CheckCircleFilledIcon,s=e.ErrorCircleFilledIcon,a={info:t(o,{class:"".concat(this.classPrefix,"-is-info")}),warning:t(s,{class:"".concat(this.classPrefix,"-is-warning")}),danger:t(s,{class:"".concat(this.classPrefix,"-is-error")}),success:t(i,{class:"".concat(this.classPrefix,"-is-success")})};return a[this.theme]},mousedownHandler:function(t){var e=this.$refs.dialog;this.disX=t.clientX-e.offsetLeft,this.disY=t.clientY-e.offsetTop,this.dialogW=e.offsetWidth,this.dialogH=e.offsetHeight,this.windowInnerWidth=window.innerWidth||document.documentElement.clientWidth,this.windowInnerHeight=window.innerHeight||document.documentElement.clientHeight,!(this.dialogW>this.windowInnerWidth||this.dialogH>this.windowInnerHeight)&&(document.addEventListener("mousemove",this.mouseMoverHandler),document.addEventListener("mouseup",this.mouseUpHandler),document.addEventListener("dragend",this.mouseUpHandler))},mouseMoverHandler:function(t){var e=this.$refs.dialog,o=t.clientX-this.disX,i=t.clientY-this.disY;o<0&&(o=0),i<0&&(i=0),this.windowInnerWidth-e.offsetWidth-o<0&&(o=this.windowInnerWidth-e.offsetWidth),this.windowInnerHeight-e.offsetHeight-i<0&&(i=this.windowInnerHeight-e.offsetHeight),e.style.position="absolute",e.style.left="".concat(o,"px"),e.style.top="".concat(i,"px")},mouseUpHandler:function(){document.removeEventListener("mousemove",this.mouseMoverHandler),document.removeEventListener("mouseup",this.mouseUpHandler),document.removeEventListener("dragend",this.mouseUpHandler)},initDragEvent:function(t){var e=this.$refs.dialog;t?e.addEventListener("mousedown",this.mousedownHandler):e.removeEventListener("mousedown",this.mousedownHandler)},resizeAdjustPosition:function(){if(this.visible){var t=this.$refs.dialog;t.style.left="".concat(this.dLeft*(window.innerWidth/this.windowInnerWidth),"px"),t.style.top="".concat(this.dTop*(window.innerHeight/this.windowInnerHeight),"px")}},onStopDown:function(t){this.isModeLess&&this.draggable&&t.stopPropagation()},renderDialog:function(){var t=this.$createElement,e=this.useGlobalIcon({CloseIcon:H}),o=e.CloseIcon,i=t("h5",{class:"title"}),s=t(o),a=K(this,"default","body"),r=t("div",[this.getCancelBtn({cancelBtn:this.cancelBtn,globalCancel:this.global.cancel,className:"".concat(this.componentName,"__cancel")}),this.getConfirmBtn({theme:this.theme,confirmBtn:this.confirmBtn,globalConfirm:this.global.confirm,globalConfirmBtnTheme:this.global.confirmBtnTheme,className:"".concat(this.componentName,"__confirm")})]),u=this.footer?t("div",{class:"".concat(this.componentName,"__footer"),on:{mousedown:this.onStopDown}},[h(this,"footer",r)]):null;return t("div",{class:this.wrapClass},[t("div",{class:this.positionClass,style:this.positionStyle,on:{click:this.overlayAction},ref:"dialogPosition"},[t("div",{key:"dialog",ref:"dialog",class:this.dialogClass,style:this.dialogStyle},[t("div",{class:"".concat(this.componentName,"__header"),on:{mousedown:this.onStopDown}},[this.getIcon(),h(this,"header",i)]),this.closeBtn?t("span",{class:"".concat(this.componentName,"__close"),on:{click:this.closeBtnAction}},[h(this,"closeBtn",s)]):null,t("div",{class:this.bodyClass,on:{mousedown:this.onStopDown}},[a]),u])])])}},render:function(){var t=arguments[0],e=this.isModal&&t("div",{key:"mask",class:this.maskClass}),o=this.renderDialog(),i=[e,o],s={zIndex:this.zIndex};return t("transition",{attrs:{duration:300,name:"".concat(this.componentName,"-zoom__vue")},on:{afterEnter:this.afterEnter,afterLeave:this.afterLeave}},[(!this.destroyOnClose||this.visible)&&t("div",{directives:[{name:"show",value:this.visible},{name:"transfer-dom",value:this.attach}],class:this.ctxClass,style:s},[i])])}});/**
 * tdesign v0.49.3
 * (c) 2022 tdesign
 * @license MIT
 */function _(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);t&&(o=o.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),e.push.apply(e,o)}return e}function v(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?_(Object(e),!0).forEach(function(o){d(n,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):_(Object(e)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(e,o))})}return n}var E=function(t){var e=v({},t),o=new et({propsData:v(v({},e),{},{onClose:e.onClose||function(){o.visible=!1}})}).$mount();o.visible=!0,e.className&&e.className.split(" ").forEach(function(a){o.$el.classList.add(a.trim())}),e.style&&(o.$el.style.cssText+=e.style);var i=Y(e.attach);i?i.appendChild(o.$el):console.error("attach is not exist");var s={show:function(){o.visible=!0},hide:function(){o.visible=!1},update:function(r){Object.assign(o,r)},destroy:function(){o.visible=!1,i.contains(o.$el)&&i.removeChild(o.$el)}};return s},nt=function(t){return E(t)},ot=function(t){var e=v({},t);return e.cancelBtn=null,E(e)},y={confirm:nt,alert:ot},N={install:function(){B.prototype.$dialog=E,Object.keys(y).forEach(function(t){B.prototype.$dialog[t]=y[t]})}};Object.keys(y).forEach(function(n){N[n]=y[n]});var ut=N;export{p as B,ut as D};
